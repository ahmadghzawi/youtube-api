{"ast":null,"code":"'use strict';\n/*global ActiveXObject:true*/\n\nvar defaults = require('./../defaults');\n\nvar utils = require('./../utils');\n\nvar buildUrl = require('./../helpers/buildUrl');\n\nvar parseHeaders = require('./../helpers/parseHeaders');\n\nvar transformData = require('./../helpers/transformData');\n\nmodule.exports = function xhrAdapter(resolve, reject, config) {\n  // Transform request data\n  var data = transformData(config.data, config.headers, config.transformRequest); // Merge headers\n\n  var requestHeaders = utils.merge(defaults.headers.common, defaults.headers[config.method] || {}, config.headers || {});\n\n  if (utils.isFormData(data)) {\n    delete requestHeaders['Content-Type']; // Let the browser set it\n  } // Create the request\n\n\n  var request = new (XMLHttpRequest || ActiveXObject)('Microsoft.XMLHTTP');\n  request.open(config.method.toUpperCase(), buildUrl(config.url, config.params), true); // Set the request timeout in MS\n\n  request.timeout = config.timeout; // Listen for ready state\n\n  request.onreadystatechange = function () {\n    if (request && request.readyState === 4) {\n      // Prepare the response\n      var responseHeaders = parseHeaders(request.getAllResponseHeaders());\n      var responseData = ['text', ''].indexOf(config.responseType || '') !== -1 ? request.responseText : request.response;\n      var response = {\n        data: transformData(responseData, responseHeaders, config.transformResponse),\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config: config\n      }; // Resolve or reject the Promise based on the status\n\n      (request.status >= 200 && request.status < 300 ? resolve : reject)(response); // Clean up request\n\n      request = null;\n    }\n  }; // Add xsrf header\n  // This is only done if running in a standard browser environment.\n  // Specifically not if we're in a web worker, or react-native.\n\n\n  if (utils.isStandardBrowserEnv()) {\n    var cookies = require('./../helpers/cookies');\n\n    var urlIsSameOrigin = require('./../helpers/urlIsSameOrigin'); // Add xsrf header\n\n\n    var xsrfValue = urlIsSameOrigin(config.url) ? cookies.read(config.xsrfCookieName || defaults.xsrfCookieName) : undefined;\n\n    if (xsrfValue) {\n      requestHeaders[config.xsrfHeaderName || defaults.xsrfHeaderName] = xsrfValue;\n    }\n  } // Add headers to the request\n\n\n  utils.forEach(requestHeaders, function (val, key) {\n    // Remove Content-Type if data is undefined\n    if (!data && key.toLowerCase() === 'content-type') {\n      delete requestHeaders[key];\n    } // Otherwise add header to the request\n    else {\n        request.setRequestHeader(key, val);\n      }\n  }); // Add withCredentials to request if needed\n\n  if (config.withCredentials) {\n    request.withCredentials = true;\n  } // Add responseType to request if needed\n\n\n  if (config.responseType) {\n    try {\n      request.responseType = config.responseType;\n    } catch (e) {\n      if (request.responseType !== 'json') {\n        throw e;\n      }\n    }\n  }\n\n  if (utils.isArrayBuffer(data)) {\n    data = new DataView(data);\n  } // Send the request\n\n\n  request.send(data);\n};","map":null,"metadata":{},"sourceType":"script"}